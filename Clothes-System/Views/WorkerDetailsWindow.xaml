<Window x:Class="Clothes_System.Views.WorkerDetailsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:helpers="clr-namespace:Clothes_System.Helpers"
        Title="تفاصيل العامل" Height="500" Width="520"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        FlowDirection="RightToLeft"
        Background="#F0F4F8">

    <Window.Resources>
        <helpers:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>
    </Window.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="15" Orientation="Vertical" >

            <!-- Header -->
            <TextBlock Text="{Binding Worker.Name}" FontWeight="Bold" FontSize="18" Margin="0,0,0,5"/>
            <TextBlock Text="{Binding Worker.Ph_Number}" FontStyle="Italic" Foreground="Gray" Margin="0,0,0,15"/>

            <!-- Add Pieces (only for non-weekly workers) -->
            <StackPanel Orientation="Horizontal"
                        Visibility="{Binding Worker.Is_Weekly, Converter={StaticResource InverseBoolToVisibilityConverter}}"
                        Margin="0,0,0,15">
                <TextBox Width="100"
                         Margin="0,0,5,0"
                         Text="{Binding NewWorkerPieces, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="عدد القطع الجديدة"/>
                <Button Content="إضافة قطع"
                        Width="100"
                        Background="#007ACC"
                        Foreground="White"
                        FontWeight="Bold"
                        Command="{Binding AddWorkerPieceCommand}" />
            </StackPanel>

            <!-- Payment Section -->
            <GroupBox Header="إضافة دفعة" Margin="0,0,0,15">
                <StackPanel Orientation="Horizontal" Margin="5">
                    <TextBox Width="100"
                             Margin="0,0,5,0"
                             Text="{Binding PaymentAmount, UpdateSourceTrigger=PropertyChanged}"
                             ToolTip="المبلغ"/>
                    <ComboBox Width="120"
                              SelectedItem="{Binding SelectedPaymentType, UpdateSourceTrigger=PropertyChanged}"
                              ItemsSource="{Binding PaymentTypes}"/>
                    <Button Content="إضافة دفعة"
                            Width="120"
                            Margin="5,0,0,0"
                            Background="#28A745"
                            Foreground="White"
                            FontWeight="Bold"
                            Command="{Binding AddWorkerPaymentCommand}" />
                </StackPanel>
            </GroupBox>

            <!-- Daily Pieces -->
            <GroupBox Header="قطع يومية" Margin="0,0,0,15">
                <DataGrid ItemsSource="{Binding Worker.DailyPieces}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          Margin="5"
                          IsReadOnly="True"
                          AlternatingRowBackground="#E6F0FA"
                          RowBackground="White"
                          HeadersVisibility="Column">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="التاريخ" Binding="{Binding Date, StringFormat={}{0:dd/MM/yyyy}}" Width="*" />
                        <DataGridTextColumn Header="عدد القطع" Binding="{Binding Pieces}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>

            <!-- Payment History -->
            <GroupBox Header="سجل الدفعات" Margin="0,0,0,15">
                <DataGrid ItemsSource="{Binding Worker.BankTransactions}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          Margin="5"
                          IsReadOnly="True"
                          AlternatingRowBackground="#E6F0FA"
                          RowBackground="White"
                          HeadersVisibility="Column">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="التاريخ" Binding="{Binding Date, StringFormat={}{0:dd/MM/yyyy}}" Width="*" />
                        <DataGridTextColumn Header="المبلغ" Binding="{Binding Amount}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>

        </StackPanel>
    </ScrollViewer>
</Window>
